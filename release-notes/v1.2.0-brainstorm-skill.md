# Aria Plugin v1.2.0 - Brainstorm Skill 发布说明

> **发布日期**: 2026-02-05
> **版本**: 1.2.0
> **类型**: Minor (新功能)

---

## 概述

本次发布引入 **Brainstorm Skill**，这是 Aria AI-DDD 方法论的重要补充。它为 AI 与人类的协作思考提供了结构化的对话框架，实现从"模糊想法"到"明确决策"的完整流程。

---

## 核心新增: Brainstorm Skill

### 问题背景

传统开发流程存在根本性问题：
```
人类思考 → 写文档 → AI 读取理解 → 执行
```

- AI 无法参与"为什么"的讨论，只能在"做什么"上执行
- 决策理由丢失，后期无法追溯
- 需求澄清不足，过早进入实现导致返工

### 解决方案

Brainstorm Skill 将流程转变为：
```
人类 + AI 协作思考 → 共同理解 → 文档记录 → 执行
```

---

## 功能特性

### 三种工作模式

| 模式 | 触发时机 | 目标 | 输出 |
|------|----------|------|------|
| **problem** | 用户提出模糊想法 | 澄清问题本质，区分真/伪需求 | problem-definition.md |
| **requirements** | PRD 创建/细化 | 分解 User Stories，确定优先级 | user-stories/*.md |
| **technical** | OpenSpec 创建前 | 技术选型，方案对比 | decision-log.md |

### 对话状态机

```
INIT → CLARIFY → EXPLORE → CONVERGE → SUMMARY → COMPLETE
```

| 状态 | 目标 | 最大问题数 |
|------|------|-----------|
| CLARIFY | 统一术语，建立共同理解 | 3 |
| EXPLORE | 探索方案，收集约束 | 5 |
| CONVERGE | 方案对比，风险评估 | 3 |

### 决策记录

```markdown
# 决策: DEC-20260205-001 - AI 客服技术方案

> **日期**: 2026-02-05 | **模式**: technical

## 背景
用户需要 24/7 可用的客服支持...

## 约束条件
| 类型 | 约束 | 影响 |
|------|------|------|
| business | 预算 < $500/月 | 排除昂贵托管服务 |
| technical | 私有化部署 | 需要自建 RAG |

## 考虑的方案
| 方案 | 评分 | 可行性 | 理由 |
|------|------|--------|------|
| A: OpenAI API | ❌ | 不可行 | 数据出境 |
| B: 自建 RAG | ✅ | 可行 | 满足约束 |

## 最终选择
**方案 B**: 自建 RAG (FAISS + 本地模型)

## 理由
1. 满足合规要求 (数据不出境)
2. 成本可控
3. 满足初期性能需求
```

---

## 集成增强

### state-scanner 增强

新增推荐规则：
- `fuzziness_requirement` - 需求模糊时推荐 problem 模式
- `missing_prd` - 复杂功能推荐先创建 PRD
- `prd_refinement` - PRD 需要细化推荐 requirements 模式
- `tech_design_needed` - 有就绪 Story 无 OpenSpec 推荐 technical 模式

### spec-drafter 增强

- PRD 创建时自动触发 requirements 模式
- OpenSpec 创建时自动触发 technical 模式
- 基于讨论结果预填充 proposal.md
- 决策引用系统，支持完整追溯链

### workflow-runner 增强

新增 A.0.5 步骤 (问题空间头脑风暴)：
```
A. 规划阶段
├── A.0 状态扫描
├── A.0.5 问题空间头脑风暴 ← 新增
├── A.1 规范创建
├── A.2 任务规划
└── A.3 Agent 分配
```

---

## 技术亮点

### Progressive Disclosure 架构

SKILL.md 从 1723 行优化到 357 行 (-79%)：

```
Level 1: Metadata (始终加载)
  └── name + description

Level 2: SKILL.md (触发时加载, 357 行)
  ├── 快速开始
  ├── 核心功能
  ├── 三种模式概述
  └── 配置 + 示例

Level 3: References (按需加载)
  ├── references/*.md (737 行)
  ├── templates/*.md (751 行)
  ├── config/*.yaml (268 行)
  └── examples/*.md (447 行)
```

### 约束管理系统

```yaml
约束分类:
  business:
    - budget: 预算限制
    - timeline: 时间限制
    - compliance: 合规要求
  technical:
    - deployment: 部署方式
    - tech_stack: 技术栈限制
    - performance: 性能要求
  team:
    - skills: 团队技能
    - capacity: 可用工时
```

---

## 使用示例

### Problem 模式

```
用户: /brainstorm problem "我想给应用加个AI功能"

AI: 让我们先理解一下你想要解决的问题。
     [问题澄清]
     1. 你说的 AI 功能具体指什么？
      - a) 智能推荐  b) 自动补全  c) 对话助手  d) 其他

用户: c，我想做一个智能客服

AI: 明白了，智能客服助手。让我们继续澄清：
     2. 这个客服要解决什么问题？
     ...

[最终输出]
╔═══════════════════════════════════════════════════════════╗
║                     问题定义                               ║
║ 核心问题: 用户咨询得不到及时响应                           ║
║ 约束: 预算<$500, 私有化部署                               ║
╚═══════════════════════════════════════════════════════════╝
```

---

## 文件结构

```
aria/skills/brainstorm/
├── SKILL.md (357 行)
├── SKILL_DESIGN.md
├── config-example.md
├── config/
│   ├── state-machine.yaml
│   └── constraints.yaml
├── references/
│   ├── STATE_MACHINE.md
│   ├── DEPTH_CONTROL.md
│   └── DECISION_WORKFLOW.md
├── templates/
│   ├── problem.md
│   ├── requirements.md
│   ├── technical.md
│   ├── common.md
│   └── decision-template.md
├── examples/
│   ├── problem-dialogue.md
│   ├── technical-dialogue.md
│   └── error-scenarios.md
└── testing/
    └── e2e-test-scenarios.md
```

---

## 升级指南

### 配置 (可选)

在项目根目录创建 `.claude/aria.local.md`:

```yaml
brainstorm:
  enabled: true
  trigger_mode: auto
  auto_trigger:
    fuzziness_threshold: 0.6
    complexity_threshold: Level2
  conversation:
    max_rounds:
      problem: 10
      requirements: 15
      technical: 8
  output:
    save_decisions: true
    decision_dir: docs/decisions/
    auto_sync_openspec: true
```

### 决策记录目录

创建决策存储目录：

```bash
mkdir -p docs/decisions
```

---

## 兼容性

| 项目 | 兼容性 | 说明 |
|------|--------|------|
| 向后兼容 | ✅ 完全兼容 | 可选启用，不影响现有流程 |
| Claude Code | ✅ 支持 | v1.0.0+ |
| Claude Plugin API | ✅ 支持 | 稳定 |

---

## 已知问题

1. **用户测试未完成** - Phase 3.2 需要真实用户参与
2. **性能优化待验证** - Phase 3.3 性能指标未实测

---

## 后续计划

| 优先级 | 任务 | 预计时间 |
|--------|------|----------|
| High | 用户测试反馈 | 16h |
| Medium | 性能优化 | 4h |
| Low | 更多示例对话 | 4h |

---

## 致谢

Brainstorm Skill 的设计灵感来自 [Superpowers brainstorming](https://github.com/obra/superpowers) 项目。

---

**维护者**: 10CG Lab
**许可证**: MIT
**仓库**: https://forgejo.10cg.pub/10CG/aria-plugin
