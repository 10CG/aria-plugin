{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://10cg.pub/schemas/tdd-config-v2.0.json",
  "title": "TDD Enforcer Configuration",
  "description": "Configuration schema for TDD Enforcer v2.0 (Document-Driven Design)",
  "type": "object",
  "required": [],
  "properties": {
    "enabled": {
      "type": "boolean",
      "description": "Whether TDD enforcement is enabled",
      "default": true
    },
    "strictness": {
      "type": "string",
      "description": "TDD enforcement strictness level",
      "enum": ["advisory", "strict", "superpowers"],
      "default": "advisory"
    },
    "skip_patterns": {
      "type": "array",
      "description": "File patterns to skip TDD checking",
      "items": {
        "type": "string"
      },
      "default": [
        "**/*.md",
        "**/*.json",
        "**/*.yaml",
        "**/*.yml",
        "**/config/**",
        "**/migrations/**",
        "**/fixtures/**",
        "**/mock*/**",
        "**/node_modules/**",
        "**/.venv/**",
        "**/venv/**",
        "**/__pycache__/**",
        "**/build/**",
        "**/dist/**",
        "**/.git/**"
      ]
    },
    "test_patterns": {
      "type": "object",
      "description": "Test file patterns for each language",
      "properties": {
        "python": {
          "type": "array",
          "items": {"type": "string"},
          "default": ["test_*.py", "*_test.py"]
        },
        "javascript": {
          "type": "array",
          "items": {"type": "string"},
          "default": ["*.test.js", "*.spec.js"]
        },
        "typescript": {
          "type": "array",
          "items": {"type": "string"},
          "default": ["*.test.ts", "*.spec.ts"]
        },
        "dart": {
          "type": "array",
          "items": {"type": "string"},
          "default": ["*_test.dart"]
        },
        "go": {
          "type": "array",
          "items": {"type": "string"},
          "default": ["*_test.go"]
        }
      }
    },
    "green_phase_limits": {
      "type": "object",
      "description": "GREEN phase enforcement limits (superpowers only)",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": false
        },
        "max_lines_after_pass": {
          "type": "integer",
          "description": "Maximum lines of code allowed after tests pass",
          "minimum": 0,
          "default": 50
        },
        "max_new_functions": {
          "type": "integer",
          "description": "Maximum new functions allowed after tests pass",
          "minimum": 0,
          "default": 3
        },
        "warn_on_exceed": {
          "type": "boolean",
          "description": "Whether to warn when limits are exceeded",
          "default": true
        }
      }
    },
    "golden_testing_detection": {
      "type": "object",
      "description": "Golden test detection configuration (superpowers only)",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": false
        },
        "patterns": {
          "type": "array",
          "description": "Patterns that indicate golden (always-passing) tests",
          "items": {
            "type": "object",
            "properties": {
              "pattern": {
                "type": "string",
                "description": "Regex pattern to detect"
              },
              "description": {
                "type": "string",
                "description": "Description of the pattern"
              },
              "severity": {
                "type": "string",
                "enum": ["warning", "error"],
                "description": "Severity level"
              }
            },
            "required": ["pattern", "severity"]
          },
          "default": [
            {"pattern": "assert True", "description": "Always-passing assertion", "severity": "error"},
            {"pattern": "assert False", "description": "Always-passing assertion", "severity": "error"},
            {"pattern": "@skip", "description": "Skipped test", "severity": "warning"},
            {"pattern": "test.skip\\(", "description": "Skipped test (JS)", "severity": "warning"}
          ]
        }
      }
    },
    "state_persistence": {
      "type": "object",
      "description": "State persistence configuration (superpowers only)",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": false
        },
        "state_file": {
          "type": "string",
          "description": "Path to state file",
          "default": ".claude/tdd-state.yaml"
        }
      }
    },
    "language_settings": {
      "type": "object",
      "description": "Language-specific settings",
      "properties": {
        "python": {
          "type": "object",
          "properties": {
            "framework": {
              "type": "string",
              "enum": ["auto", "pytest", "unittest"],
              "default": "auto"
            },
            "test_dir": {
              "type": "string",
              "default": "tests"
            }
          }
        },
        "javascript": {
          "type": "object",
          "properties": {
            "framework": {
              "type": "string",
              "enum": ["auto", "jest", "mocha", "vitest"],
              "default": "auto"
            },
            "test_dir": {
              "type": "string",
              "default": "__tests__"
            }
          }
        },
        "dart": {
          "type": "object",
          "properties": {
            "framework": {
              "type": "string",
              "enum": ["auto", "flutter", "dart"],
              "default": "auto"
            },
            "test_dir": {
              "type": "string",
              "default": "test"
            }
          }
        },
        "go": {
          "type": "object",
          "properties": {
            "framework": {
              "type": "string",
              "enum": ["auto", "builtin"],
              "default": "auto"
            },
            "test_dir": {
              "type": "string",
              "default": "."
            }
          }
        }
      }
    }
  },
  "examples": [
    {
      "description": "Default advisory configuration",
      "enabled": true,
      "strictness": "advisory"
    },
    {
      "description": "Strict mode with RED state enforcement",
      "enabled": true,
      "strictness": "strict",
      "skip_patterns": [
        "**/*.md",
        "**/*.json",
        "**/config/**"
      ]
    },
    {
      "description": "Superpowers mode with full TDD cycle enforcement",
      "enabled": true,
      "strictness": "superpowers",
      "green_phase_limits": {
        "enabled": true,
        "max_lines_after_pass": 50,
        "max_new_functions": 3,
        "warn_on_exceed": true
      },
      "golden_testing_detection": {
        "enabled": true,
        "patterns": [
          {"pattern": "assert True", "severity": "error"},
          {"pattern": "assert False", "severity": "error"},
          {"pattern": "@skip", "severity": "warning"}
        ]
      },
      "state_persistence": {
        "enabled": true,
        "state_file": ".claude/tdd-state.yaml"
      }
    },
    {
      "description": "Multi-language project configuration",
      "enabled": true,
      "strictness": "strict",
      "test_patterns": {
        "python": ["test_*.py", "*_test.py"],
        "javascript": ["*.test.js", "*.spec.js"],
        "dart": ["*_test.dart"]
      },
      "language_settings": {
        "python": {
          "framework": "pytest",
          "test_dir": "tests"
        },
        "javascript": {
          "framework": "jest",
          "test_dir": "__tests__"
        },
        "dart": {
          "framework": "flutter",
          "test_dir": "test"
        }
      }
    }
  ]
}
