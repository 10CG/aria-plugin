---
name: tdd-enforcer
description: |
  å¼ºåˆ¶æ‰§è¡Œæµ‹è¯•é©±åŠ¨å¼€å‘ (TDD) å·¥ä½œæµï¼Œä½¿ç”¨ RED-GREEN-REFACTOR å¾ªç¯ç¡®ä¿æµ‹è¯•å…ˆäºä»£ç ç¼–å†™ã€‚

  ä½¿ç”¨åœºæ™¯ï¼šå¼€å‘æ–°åŠŸèƒ½æ—¶ç¡®ä¿ TDD æœ€ä½³å®è·µã€ä»£ç è´¨é‡å®¡æŸ¥ã€‚
user-invocable: true
---

# TDD å¼ºåˆ¶æ‰§è¡Œå™¨ (TDD Enforcer)

> **ç‰ˆæœ¬**: 1.2.0 | **åæ­¥å¾ªç¯**: B.2 (å¼€å‘éªŒè¯)
> **æ›´æ–°**: 2026-01-22 - æ”¯æŒåŒä¿é™©æ¨¡å¼ (æ–¹æ¡ˆ A + æ–¹æ¡ˆ B)
> **å‚è€ƒ**: obra/superpowers test-driven-development skill

## å¿«é€Ÿå¼€å§‹

### æˆ‘åº”è¯¥ä½¿ç”¨è¿™ä¸ª skill å—ï¼Ÿ

**ä½¿ç”¨åœºæ™¯**:
- ç¼–å†™æ–°åŠŸèƒ½ä»£ç æ—¶
- éœ€è¦ç¡®ä¿æµ‹è¯•è¦†ç›–ç‡
- ä»£ç è´¨é‡æ£€æŸ¥å‰

**ä¸ä½¿ç”¨åœºæ™¯**:
- æ–‡æ¡£ä¿®æ”¹ â†’ æ— éœ€ TDD
- é…ç½®æ–‡ä»¶ä¿®æ”¹ â†’ æ ¹æ®é¡¹ç›®è§„åˆ™å†³å®š
- é‡æ„å·²æœ‰æµ‹è¯• â†’ è·³è¿‡ RED é˜¶æ®µ

---

## æ ¸å¿ƒåŠŸèƒ½

| åŠŸèƒ½ | æè¿° |
|------|------|
| **RED é˜¶æ®µå¼ºåˆ¶** | ç¼–å†™ä¸šåŠ¡ä»£ç å‰å¿…é¡»å­˜åœ¨å¤±è´¥æµ‹è¯• |
| **GREEN é˜¶æ®µéªŒè¯** | æœ€å°å®ç°ä½¿æµ‹è¯•é€šè¿‡ |
| **REFACTOR é˜¶æ®µ** | é‡æ„ä»£ç ä¿æŒæµ‹è¯•é€šè¿‡ |
| **åˆ é™¤ä¿æŠ¤** | åˆ é™¤æµ‹è¯•å‰éªŒè¯æ— ä¸šåŠ¡ä»£ç ä¾èµ– |
| **çŠ¶æ€æ£€æµ‹** | è‡ªåŠ¨è¯†åˆ«å½“å‰ TDD é˜¶æ®µ |

---

## RED-GREEN-REFACTOR å¾ªç¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚   RED (å¤±è´¥æµ‹è¯•)     GREEN (æœ€å°å®ç°)    REFACTOR (é‡æ„)    â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                                             â”‚
â”‚   1. ç¼–å†™æµ‹è¯•        1. ç¼–å†™æœ€å°ä»£ç        1. ä¼˜åŒ–ç»“æ„       â”‚
â”‚   2. è¿è¡Œæµ‹è¯•        2. è¿è¡Œæµ‹è¯•           2. æå–æŠ½è±¡       â”‚
â”‚   3. ç¡®è®¤å¤±è´¥        3. ç¡®è®¤é€šè¿‡           3. è¿è¡Œæµ‹è¯•       â”‚
â”‚   4. åœæ­¢ç¼–ç         4. åœæ­¢æ‰©å±•           4. ç¡®è®¤é€šè¿‡       â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é˜¶æ®µè¿›å…¥/é€€å‡ºæ¡ä»¶

| é˜¶æ®µ | è¿›å…¥æ¡ä»¶ | é€€å‡ºæ¡ä»¶ |
|------|---------|---------|
| **RED** | æ–°åŠŸèƒ½éœ€æ±‚ | å­˜åœ¨å¤±è´¥æµ‹è¯• |
| **GREEN** | æœ‰å¤±è´¥æµ‹è¯• | æ‰€æœ‰æµ‹è¯•é€šè¿‡ |
| **REFACTOR** | æ‰€æœ‰æµ‹è¯•é€šè¿‡ | ä»£ç è´¨é‡æ»¡æ„ï¼Œæµ‹è¯•ä»é€šè¿‡ |

---

## ä½¿ç”¨æµç¨‹

### 1. å¼€å§‹æ–°åŠŸèƒ½ (RED é˜¶æ®µ)

```yaml
ç”¨æˆ·: "æˆ‘è¦æ·»åŠ ç”¨æˆ·ç™»å½•åŠŸèƒ½"

TDD Enforcer æ£€æŸ¥:
  1. æœç´¢å¯¹åº”æµ‹è¯•æ–‡ä»¶
     - Python: test_*.py æˆ– *_test.py
     - JavaScript: *.test.js
     - Dart: *_test.dart

  2. å¦‚æœæµ‹è¯•æ–‡ä»¶ä¸å­˜åœ¨:
     â†’ æ‹¦æˆª: "è¯·å…ˆç¼–å†™å¤±è´¥æµ‹è¯• (RED é˜¶æ®µ)"
     â†’ æŒ‡å¯¼: æä¾›æµ‹è¯•æ¨¡æ¿

  3. å¦‚æœæµ‹è¯•å­˜åœ¨ä½†å…¨éƒ¨é€šè¿‡:
     â†’ è­¦å‘Š: "æµ‹è¯•å·²é€šè¿‡ï¼Œè¯·æ·»åŠ æ–°æµ‹è¯•ç”¨ä¾‹"
```

### 2. ç¼–å†™å®ç° (GREEN é˜¶æ®µ)

```yaml
ç”¨æˆ·: "æµ‹è¯•å†™å¥½äº†ï¼Œå¼€å§‹å®ç°"

TDD Enforcer éªŒè¯:
  1. ç¡®è®¤å­˜åœ¨å¤±è´¥æµ‹è¯•
  2. å…è®¸ç¼–å†™æœ€å°å®ç°
  3. æé†’: "ä»…å®ç°è¶³ä»¥é€šè¿‡æµ‹è¯•çš„ä»£ç "

è¿åæ£€æµ‹:
  - å¦‚æœåœ¨æµ‹è¯•é€šè¿‡åç»§ç»­æ·»åŠ åŠŸèƒ½
  â†’ è­¦å‘Š: "æµ‹è¯•å·²é€šè¿‡ï¼Œè¿›å…¥ REFACTOR æˆ–åœæ­¢"
```

### 3. é‡æ„ä¼˜åŒ– (REFACTOR é˜¶æ®µ)

```yaml
ç”¨æˆ·: "åŠŸèƒ½å®ç°äº†ï¼Œç°åœ¨é‡æ„"

TDD Enforcer ç›‘æ§:
  1. ç¡®è®¤æ‰€æœ‰æµ‹è¯•é€šè¿‡
  2. å…è®¸ä»£ç é‡æ„
  3. æ¯æ¬¡ç¼–è¾‘åéªŒè¯æµ‹è¯•

ä¿æŠ¤æœºåˆ¶:
  - é‡æ„å¯¼è‡´æµ‹è¯•å¤±è´¥
  â†’ ç«‹å³è­¦å‘Š: "é‡æ„ç ´åäº†æµ‹è¯•ï¼Œè¯·ä¿®å¤"
```

### 4. åˆ é™¤æµ‹è¯•ä¿æŠ¤

```yaml
ç”¨æˆ·: "æˆ‘è¦åˆ é™¤è¿™ä¸ªæµ‹è¯•"

TDD Enforcer åˆ†æ:
  1. æœç´¢ä»£ç ä¸­å¯¹è¯¥æµ‹è¯•çš„ä¾èµ–
     - æµ‹è¯•çš„æ–­è¨€å¯¹åº”çš„åŠŸèƒ½ä»£ç 
     - æµ‹è¯•è¦†ç›–çš„å‡½æ•°/æ–¹æ³•

  2. å¦‚æœå‘ç°ä¾èµ–:
     â†’ é˜»æ­¢: "ä»¥ä¸‹ä»£ç ä¾èµ–æ­¤æµ‹è¯•ï¼Œè¯·å…ˆåˆ é™¤"
     â†’ åˆ—å‡ºä¾èµ–æ–‡ä»¶å’Œè¡Œå·

  3. å¦‚æœæ— ä¾èµ–:
     â†’ å…è®¸åˆ é™¤
```

---

## æ£€æµ‹è§„åˆ™

### æ–‡ä»¶æ˜ å°„è§„åˆ™

| è¯­è¨€ | æµ‹è¯•æ–‡ä»¶æ¨¡å¼ | æºæ–‡ä»¶æ¨¡å¼ |
|------|------------|-----------|
| Python | `test_*.py`, `*_test.py` | `*.py` |
| JavaScript | `*.test.js`, `*.spec.js` | `*.js` |
| TypeScript | `*.test.ts`, `*.spec.ts` | `*.ts` |
| Dart | `*_test.dart` | `*.dart` |
| Java | `*Test.java` | `*.java` |
| Go | `*_test.go` | `*.go` |

### è¿è§„è¡Œä¸ºæ£€æµ‹

```yaml
è¿è§„ç±»å‹:
  no_test_before_code:
    æ¡ä»¶: ç¼–å†™/ç¼–è¾‘æºæ–‡ä»¶ï¼Œä½†æµ‹è¯•æ–‡ä»¶ä¸å­˜åœ¨æˆ–æµ‹è¯•æœªè¿è¡Œ
    åŠ¨ä½œ: è­¦å‘Š + å»ºè®®å…ˆå†™æµ‹è¯•

  delete_test_with_dependency:
    æ¡ä»¶: åˆ é™¤æµ‹è¯•ï¼Œä½†æœ‰æºä»£ç ä¾èµ–æµ‹è¯•è¡Œä¸º
    åŠ¨ä½œ: é˜»æ­¢ + åˆ—å‡ºä¾èµ–

  extend_after_green:
    æ¡ä»¶: æµ‹è¯•é€šè¿‡åç»§ç»­æ·»åŠ æ–°åŠŸèƒ½ä»£ç 
    åŠ¨ä½œ: è­¦å‘Š "è¯·å…ˆä¸ºæ–°åŠŸèƒ½æ·»åŠ æµ‹è¯•"

  refactor_without_tests:
    æ¡ä»¶: ç¼–è¾‘ä»£ç ä½†æµ‹è¯•æœªè¿è¡Œ
    åŠ¨ä½œ: æç¤ºè¿è¡Œæµ‹è¯•
```

---

## è¾“å…¥å‚æ•°

| å‚æ•° | å¿…éœ€ | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|------|--------|
| `file_path` | âœ… | æ­£åœ¨ç¼–è¾‘çš„æ–‡ä»¶è·¯å¾„ | - |
| `language` | âŒ | ç¼–ç¨‹è¯­è¨€ | è‡ªåŠ¨æ£€æµ‹ |
| `strict_mode` | âŒ | ä¸¥æ ¼æ¨¡å¼ (æ‹¦æˆªæ“ä½œ) | false |
| `allow_skip` | âŒ | å…è®¸è·³è¿‡ (æ–‡æ¡£/é…ç½®) | true |

---

## è¾“å‡ºæ ¼å¼

### æ­£å¸¸æµç¨‹ (æ— è¿è§„)

```yaml
status: ok
phase: "GREEN"  # RED | GREEN | REFACTOR
message: "ç»§ç»­å¼€å‘"
```

### è¿è§„è­¦å‘Š

```yaml
status: warning
phase: "RED"
violation: "no_test_before_code"
message: |
  âš ï¸ TDD è§„åˆ™è¿å: æ£€æµ‹åˆ°ç¼–å†™æºä»£ç ä½†ç¼ºå°‘å¯¹åº”æµ‹è¯•

  å½“å‰æ–‡ä»¶: src/services/auth.js
  æœŸæœ›æµ‹è¯•: tests/services/auth.test.js

  å»ºè®®æ“ä½œ:
  1. å…ˆç¼–å†™å¤±è´¥æµ‹è¯•
  2. è¿è¡Œæµ‹è¯•ç¡®è®¤å¤±è´¥
  3. ç„¶åç¼–å†™å®ç°ä»£ç 
```

### ä¸¥æ ¼æ¨¡å¼æ‹¦æˆª

```yaml
status: blocked
phase: "RED"
violation: "no_test_before_code"
message: |
  ğŸš« TDD å¼ºåˆ¶æ‹¦æˆª: ä¸¥æ ¼æ¨¡å¼ä¸‹ä¸å…è®¸è¿å TDD è§„åˆ™

  å½“å‰æ“ä½œ: ç¼–è¾‘ src/services/auth.js
  è¦æ±‚: å¿…é¡»å…ˆå­˜åœ¨ tests/services/auth.test.js ä¸­çš„å¤±è´¥æµ‹è¯•

  [å–æ¶ˆ] [äº†è§£æ›´å¤š]
```

---

## æµ‹è¯•æ¨¡æ¿

### Python æµ‹è¯•æ¨¡æ¿

```python
# test_{feature}.py

import pytest
from {module} import {function}


class Test{Feature}:
    """{Feature description}"""

    def test_{specific_case}_fails(self):
        """
        RED é˜¶æ®µ: ç¼–å†™å¤±è´¥çš„æµ‹è¯•

        Given: {precondition}
        When: {action}
        Then: {expected outcome}
        """
        # Arrange
        input = {}

        # Act & Assert
        with pytest.raises({Exception}):
            {function}(input)
```

### JavaScript æµ‹è¯•æ¨¡æ¿

```javascript
// {feature}.test.js

describe('{Feature}', () => {
  describe('{specific case}', () => {
    it('should fail initially (RED phase)', () => {
      // Arrange
      const input = {};

      // Act & Assert
      expect(() => {
        {function}(input);
      }).toThrow();
    });
  });
});
```

---

## é…ç½®

### é¡¹ç›®çº§é…ç½® (`.claude/tdd-config.json`)

```json
{
  "enabled": true,
  "strict_mode": false,
  "skip_patterns": [
    "**/*.md",
    "**/*.json",
    "**/config/**",
    "**/migrations/**"
  ],
  "test_patterns": {
    "python": ["test_*.py", "*_test.py"],
    "javascript": ["*.test.js", "*.spec.js"],
    "typescript": ["*.test.ts", "*.spec.ts"],
    "dart": ["*_test.dart"]
  },
  "require_test_ratio": 0.3
}
```

---

## ä¸å…¶ä»– Skills åä½œ

```
tdd-enforcer
    â”‚
    â”œâ”€â”€â–¶ workflow-runner (æ–¹æ¡ˆ B - v1.2.0)
    â”‚   â””â”€â”€ Pre-Hook å¯ç”¨ä¸»ä¼šè¯ TDD
    â”‚
    â”œâ”€â”€â–¶ phase-b-developer (B.2 å¼€å‘é˜¶æ®µ)
    â”‚   â”œâ”€â”€ æ–¹æ¡ˆ A: ä¼ é€’ TDD é…ç½®ç»™ subagent-driver
    â”‚   â””â”€â”€ subagent-driver ä¼ é€’ç»™ Fresh Subagent
    â”‚
    â”œâ”€â”€â–¶ qa-engineer (ä»£ç è´¨é‡è¯„å®¡)
    â”‚   â””â”€â”€ éªŒè¯ TDD å®è·µæ˜¯å¦åˆè§„
    â”‚
    â”œâ”€â”€â–¶ strategic-commit-orchestrator
    â”‚   â””â”€â”€ æäº¤å‰éªŒè¯æµ‹è¯•çŠ¶æ€
    â”‚
    â””â”€â”€â–¶ branch-finisher (v1.1.0 æ–°å¢)
        â””â”€â”€ å®Œæˆé˜¶æ®µæµ‹è¯•éªŒè¯ (äº’è¡¥å…³ç³»)
```

### ä¸ branch-finisher çš„äº’è¡¥å…³ç³»

```yaml
èŒè´£åˆ’åˆ†:
  tdd-enforcer:
    timing: å¼€å‘è¿‡ç¨‹ä¸­ (PreToolUse hook)
    focus: ç¡®ä¿æµ‹è¯•å…ˆäºä»£ç ç¼–å†™ (TDD æµç¨‹)
    enforcement: RED-GREEN-REFACTOR å¾ªç¯

  branch-finisher:
    timing: å¼€å‘å®Œæˆå (Post-development)
    focus: ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡ (è´¨é‡é—¨ç¦)
    enforcement: æµ‹è¯•å‰ç½®éªŒè¯

äº’è¡¥æµç¨‹:
  1. å¼€å‘é˜¶æ®µ (tdd-enforcer)
     â”œâ”€â”€ ç¼–å†™æµ‹è¯• (RED)
     â”œâ”€â”€ ç¼–å†™å®ç° (GREEN)
     â””â”€â”€ é‡æ„ä¼˜åŒ– (REFACTOR)

  2. å®Œæˆé˜¶æ®µ (branch-finisher)
     â”œâ”€â”€ è¿è¡Œæ‰€æœ‰æµ‹è¯•
     â”œâ”€â”€ ç±»å‹æ£€æŸ¥
     â”œâ”€â”€ æ„å»ºéªŒè¯
     â””â”€â”€ 4é€‰é¡¹å®Œæˆæµç¨‹

æ— å†²çªç‚¹:
  - tdd-enforcer åœ¨ç¼–ç æ—¶æ‹¦æˆª
  - branch-finisher åœ¨å®Œæˆæ—¶éªŒè¯
  - ä¸¤è€…ä½œç”¨äºä¸åŒæ—¶é—´ç‚¹
  - å…±åŒç¡®ä¿ä»£ç è´¨é‡
```

---

## æ£€æŸ¥æ¸…å•

### ä½¿ç”¨å‰
- [ ] ç¡®è®¤é¡¹ç›®éœ€è¦ TDD å¼ºåˆ¶æ‰§è¡Œ
- [ ] é…ç½® `tdd-config.json` (å¯é€‰)

### ä½¿ç”¨å
- [ ] æµ‹è¯•æ–‡ä»¶å·²åˆ›å»º
- [ ] RED-GREEN-REFACTOR å¾ªç¯å®Œæ•´
- [ ] æ—  TDD è§„åˆ™è¿å

---

## é”™è¯¯å¤„ç†

| é”™è¯¯ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|----------|
| æ— æ³•æ£€æµ‹è¯­è¨€ | æ–‡ä»¶æ‰©å±•åæœªçŸ¥ | æ‰‹åŠ¨æŒ‡å®š language å‚æ•° |
| æµ‹è¯•æ–‡ä»¶æœªæ‰¾åˆ° | ä¸ç¬¦åˆå‘½åè§„èŒƒ | é…ç½® test_patterns |
| ä¾èµ–åˆ†æå¤±è´¥ | ä»£ç ç»“æ„å¤æ‚ | äººå·¥æ£€æŸ¥ä¾èµ– |

---

## ç›¸å…³æ–‡æ¡£

- [superpowers-vs-aria.md](../../../docs/analysis/superpowers-vs-aria.md) - å¯¹æ¯”åˆ†æ
- [TDD æœ€ä½³å®è·µ](https://github.com/obra/superpowers) - Superpowers å‚è€ƒ
- [Agent Skills è§„èŒƒ](https://agentskills.io/specification) - å®˜æ–¹è§„èŒƒ
- [phase-b-developer](../phase-b-developer/SKILL.md) - Phase B å¼€å‘ (æ–¹æ¡ˆ A)
- [workflow-runner](../workflow-runner/SKILL.md) - å·¥ä½œæµç¼–æ’ (æ–¹æ¡ˆ B)
- [subagent-driver](../subagent-driver/SKILL.md) - Fresh Subagent æ‰§è¡Œ

---

## TDD åŒä¿é™©æ¨¡å¼ (v1.2.0 æ–°å¢)

> **è®¾è®¡ç›®æ ‡**: ç¡®ä¿æ— è®ºé€šè¿‡ä½•ç§æ–¹å¼æ‰§è¡Œä»£ç ç¼–å†™ï¼ŒTDD è§„åˆ™éƒ½ä¼šè¢«å¼ºåˆ¶æ‰§è¡Œ

### åŒä¿é™©æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        TDD åŒä¿é™©æ¶æ„                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  workflow-runner (æ–¹æ¡ˆ B)                                               â”‚
â”‚       â”‚                                                                 â”‚
â”‚       â”œâ”€â”€ Pre-Hook: å¯ç”¨ä¸»ä¼šè¯ TDD                                      â”‚
â”‚       â”‚   â””â”€â”€ tdd-enforcer --enable                                     â”‚
â”‚       â”‚         â””â”€â”€ ä¿æŠ¤ç”¨æˆ·ç›´æ¥ç¼–è¾‘ã€IDE æ“ä½œ                          â”‚
â”‚       â”‚                                                                 â”‚
â”‚       â””â”€â”€â–¶ phase-b-developer                                            â”‚
â”‚             â”‚                                                           â”‚
â”‚             â””â”€â”€â–¶ subagent-driver (æ–¹æ¡ˆ A)                               â”‚
â”‚                   â””â”€â”€ ä¼ é€’ TDD é…ç½®                                     â”‚
â”‚                       â””â”€â”€ Fresh Subagent                               â”‚
â”‚                           â””â”€â”€ ä¿æŠ¤å­ä¼šè¯ä¸­çš„ä»£ç ç¼–å†™                     â”‚
â”‚                                                                         â”‚
â”‚  âœ… å®Œæ•´é—­ç¯: ä¸»ä¼šè¯ + å­ä¼šè¯å…¨è¦†ç›–                                      â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ–¹æ¡ˆå¯¹æ¯”

| ç‰¹æ€§ | æ–¹æ¡ˆ A (Subagent) | æ–¹æ¡ˆ B (ä¸»ä¼šè¯ Hook) |
|------|-------------------|---------------------|
| **ä¿æŠ¤å¯¹è±¡** | Fresh Subagent (å­ä¼šè¯) | ä¸»ä¼šè¯ (ç”¨æˆ·ç›´æ¥äº¤äº’) |
| **è§¦å‘ä½ç½®** | subagent-driver ä¼ é€’é…ç½® | workflow-runner Pre-Hook |
| **å¯ç”¨æ—¶æœº** | Fresh Subagent å¯åŠ¨æ—¶ | è¿›å…¥ Phase B ä¹‹å‰ |
| **ä½œç”¨èŒƒå›´** | å­ä¼šè¯å†…çš„ä»£ç ç¼–å†™ | ä¸»ä¼šè¯å†…çš„ä»£ç ç¼–å†™ |
| **å…³é—­æ—¶æœº** | Subagent é”€æ¯æ—¶ | Phase B å®Œæˆ (å¯é€‰) |

### ä¸ºä»€ä¹ˆéœ€è¦åŒä¿é™©ï¼Ÿ

```yaml
å•ä¿æŠ¤ç‚¹çš„é—®é¢˜:

  scenario_1: åªæœ‰æ–¹æ¡ˆ A (Subagent ä¿æŠ¤)
    ç”¨æˆ·ç»•è¿‡ phase-b-developer ç›´æ¥ç¼–è¾‘
    â””â”€â”€âŒ TDD ä¿æŠ¤å¤±æ•ˆ

  scenario_2: åªæœ‰æ–¹æ¡ˆ B (ä¸»ä¼šè¯ Hook)
    phase-b-developer â†’ subagent-driver â†’ Fresh Subagent
    â””â”€â”€âŒ Fresh Subagent æ˜¯æ–°ä¼šè¯ï¼Œä¸ç»§æ‰¿ä¸»ä¼šè¯ Hook

  scenario_3: åŒä¿é™©
    phase-b-developer â†’ subagent-driver â†’ Fresh Subagent (æ–¹æ¡ˆ A)
    ç”¨æˆ·ç›´æ¥ç¼–è¾‘ (æ–¹æ¡ˆ B)
    â””â”€â”€âœ… å®Œæ•´ä¿æŠ¤
```

### ä½¿ç”¨æ¨¡å¼

```yaml
æ¨¡å¼ 1: è‡ªåŠ¨æ¨¡å¼ (æ¨è)
  è§¦å‘: state-scanner â†’ workflow-runner
  è¡Œä¸º:
    - æ£€æµ‹åˆ° Phase B
    - è‡ªåŠ¨å¯ç”¨æ–¹æ¡ˆ B (ä¸»ä¼šè¯)
    - phase-b-developer è‡ªåŠ¨å¯ç”¨æ–¹æ¡ˆ A (å­ä¼šè¯)

æ¨¡å¼ 2: æ‰‹åŠ¨æ¨¡å¼
  è§¦å‘: ç”¨æˆ·ç›´æ¥è°ƒç”¨ phase-b-developer
  è¡Œä¸º:
    - phase-b-developer è‡ªåŠ¨å¯ç”¨æ–¹æ¡ˆ A
    - æ–¹æ¡ˆ B éœ€è¦ç”¨æˆ·æ‰‹åŠ¨å¯ç”¨ tdd-enforcer

æ¨¡å¼ 3: ç¦ç”¨æ¨¡å¼
  é…ç½®: .claude/tdd-config.json { "enabled": false }
  è¡Œä¸º:
    - æ–¹æ¡ˆ A å’Œ B éƒ½ä¸å¯ç”¨
    - ä»… branch-finisher æ‰§è¡Œæµ‹è¯•éªŒè¯
```

### é…ç½®ä¼˜å…ˆçº§

```yaml
TDD é…ç½®ä¼˜å…ˆçº§ (ä»é«˜åˆ°ä½):

  1. é¡¹ç›®é…ç½® (.claude/tdd-config.json)
     {
       "enabled": false    # æœ€é«˜ä¼˜å…ˆçº§
     }

  2. ç¯å¢ƒå˜é‡ (ARIA_TDD_ENABLED)
     ARIA_TDD_ENABLED=false

  3. Phase é…ç½® (phase_b_config.tdd)
     phase_b_config:
       tdd:
         subagent_level:
           enabled: true
         session_level:
           enabled: true

  4. é»˜è®¤å€¼
     enabled: false  # å…œåº•
```

### Hook æ¨¡å¼è¯´æ˜

```yaml
æ–¹æ¡ˆ B ä½¿ç”¨ PreToolUse Hook:

  å·¥ä½œåŸç†:
    1. workflow-runner Pre-Hook è°ƒç”¨ tdd-enforcer
    2. tdd-enforcer æ³¨å†Œ PreToolUse Hook
    3. æ¯æ¬¡ Write/Edit æ“ä½œå‰è§¦å‘ Hook
    4. Hook æ£€æŸ¥ TDD è§„åˆ™æ˜¯å¦è¿å
    5. è¿è§„åˆ™é˜»æ­¢/è­¦å‘Š

  è§¦å‘æ—¶æœº:
    - ç”¨æˆ·ç›´æ¥ä½¿ç”¨ Write å·¥å…·
    - ç”¨æˆ·ç›´æ¥ä½¿ç”¨ Edit å·¥å…·
    - ä»»ä½•ä¼šä¿®æ”¹ä»£ç çš„æ“ä½œ

  ä¸è§¦å‘åœºæ™¯:
    - Read æ“ä½œ (åªè¯»)
    - Bash å‘½ä»¤ (éä»£ç ç¼–è¾‘)
    - skip_patterns åŒ¹é…çš„æ–‡ä»¶
```

---

**è®¾è®¡åŸåˆ™**: ä¿æŒ Aria ä¼ä¸šçº§ä¼˜åŠ¿çš„åŒæ—¶ï¼Œå€Ÿé‰´ Superpowers çš„ TDD å¼ºåˆ¶å®è·µï¼Œå½¢æˆ"æµ‹è¯•å…ˆäºä»£ç "çš„å¯é å¼€å‘ä¹ æƒ¯ã€‚

**æœ€åæ›´æ–°**: 2026-01-22
**Skillç‰ˆæœ¬**: 1.2.0 (æ–°å¢åŒä¿é™©æ¨¡å¼æ”¯æŒ)
